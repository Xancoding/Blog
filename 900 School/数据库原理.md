# 数据库标准语言SQL
## GROUP BY
![image.png](https://bu.dusays.com/2023/09/30/651799198791e.png)


使用 GROUP BY 子句后，SELECT子句的列名列表中只能出现分组属性和聚集函数
![image.png](https://bu.dusays.com/2023/09/30/651795c94cf97.png)

![image.png](https://bu.dusays.com/2023/09/30/651798d8cf968.png)

## 嵌套查询
内层查询不能使用 ORDER BY 子句
![image.png](https://bu.dusays.com/2023/09/30/651799d91b340.png)

![image.png](https://bu.dusays.com/2023/09/30/6517a089ab763.png)

![image.png](https://bu.dusays.com/2023/09/30/6517a0453ffab.png)
## 集合查询
![image.png](https://bu.dusays.com/2023/09/30/6517a10243790.png)

![image.png](https://bu.dusays.com/2023/09/30/6517a1d16eeae.png)

![image.png](https://bu.dusays.com/2023/09/30/6517a37a6f797.png)

## 视图
![image.png](https://bu.dusays.com/2023/09/30/6517a53a4c4fe.png)


![image.png](https://bu.dusays.com/2023/09/30/6517a517b4f5f.png)

![image.png](https://bu.dusays.com/2023/09/30/6517a6401e0fe.png)

## 小结
![image.png](https://bu.dusays.com/2023/09/30/6517a6e45b141.png)

# 关系数据理论
## BC范式
下面通过两个角度理解 BCNF 
1. 所有的函数依赖 左部 必须是 码
2. 主属性内部不存在部分和函数依赖

## 数据依赖的公理系统
### 闭包的求解
![image.png](https://bu.dusays.com/2023/09/30/6517f74b74124.png)

### 函数依赖集等价
两个函数依赖集等价是指它们的闭包等价

### 求最小函数依赖 

最小依赖集不一定唯一

右：处理成单一属性
中：去除冗余
左：处理子集，左端的子集是否就可以推出右端

![image.png](https://bu.dusays.com/2023/09/30/6517fbe7663e5.png)

### 求关系模式的候选码
先求出 最小函数依赖

- L类
- R类
- N类
- LR类

如果一个属性只在左端出现，它一定是码中的属性
如果一个属性只在右端出现，它一定不是码中的属性
如果一个属性在两端都出现，作为后备，可能是码中的属性

求闭包，看看能不能推出全集，不能的话再加上后备的属性，一直到可以找出候选码

## 模式分解
### 无损连接
<u>**判断一个分解是否保持无损连接的方法**</u>  
如果两个关系模式间的公共属性集至少包含其中一个关系的码，则此分解必定具有连接不失真性


### 依赖保持
若要将一个关系模式的极小函数依赖集中的每一个函数依赖都要保留下来，最简单的方法就是把每一个函数依赖的左右部属性组成一个模式。

<u>**判断一个分解是否保持依赖的方法**</u>  
检查每一个原来的依赖关系是否在子模式依赖关系的并的闭包内，涉及如何求一个属性集X的闭包XF+

### 分解成3NF模式保持函数依赖——合成法
![image.png](https://bu.dusays.com/2023/10/08/652242bd3a017.png)

### 分解成3NF模式（保持函数依赖又无损连接）
![image.png](https://bu.dusays.com/2023/10/08/65224423b028a.png)

![image.png](https://bu.dusays.com/2023/10/08/65224598b1600.png)

### 分解成BCNF模式集（具有无损连接性）的算法
![image.png](https://bu.dusays.com/2023/10/08/65225154e52d3.png)

![image.png](https://bu.dusays.com/2023/10/08/6522537fe5cd6.png)
![image.png](https://bu.dusays.com/2023/10/08/6522524f8efcb.png)

### 作业
![image.png](https://bu.dusays.com/2023/10/08/65223fe5d2f8d.png)

![image.png](https://bu.dusays.com/2023/10/08/65223ffc8308e.png)

